<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title></title>
        <script src="https://s3.ap-northeast-2.amazonaws.com/syp-dev-webapp/static/js/getJSON.js" type="text/javascript"></script>
        <script type="text/javascript">

        var callback_handling = function(err, data) {
            if (err != null) {
                alert('Something went wrong: ' + err);
            }
            else {
                console.log(data)
                result = data.data.result

                for (i=0; i<result.length; i++) {
                    console.log(result[i].name)
                }
            }
        }

        getResult(getRecipe())

        function getRecipe() {
            if (localStorage.getItem('recipe_id')) {
                console.log('Recipe_id is found in localStorage')
                recipe_id = localStorage.getItem('recipe_id')
                console.log(recipe_id)
            }
            else {
                console.log('No recipe_id in localStorage\nGetting from url query string...')
                recipe_id = getQueryVariable('recipe_id')
            }
            return recipe_id
        }
        function getResult(recipe_id) {
            postJSON(
                "https://g95xoism30.execute-api.ap-northeast-2.amazonaws.com/dev/personalize/result"+"?recipe_id="+recipe_id,
                {
                    "recipe_id": recipe_id
                },
                callback_handling);
        };
        function getQueryVariable(variable)
        {
               var query = window.location.search.substring(1);
               var vars = query.split("&");
               for (var i=0;i<vars.length;i++) {
                       var pair = vars[i].split("=");
                       if(pair[0] == variable){return pair[1];}
               }
               return false;
        }
        </script>
    </head>
    <body>
        결과페이지입니다.
    </body>
</html>
